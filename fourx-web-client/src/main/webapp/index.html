<!DOCTYPE html>
<html>
<head>
  <title>FourX</title>
  <!--Bootstrap stuff >> -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <!-- remove http: when deployed -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- << Bootstrap stuff-->
  <style>
    body {
    	background: url(img/hubble-m45_small.jpg) no-repeat center center fixed;
    	-webkit-background-size: cover;
    	-moz-background-size: cover;
    	-o-background-size: cover;
    	background-size: cover;
    	padding-top: 70px;
    	padding-bottom: 30px;
    }
    #map_container {
    	background: #000;
    	width: 1000px;
    	height: 600px;
    }
  </style>
</head>
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Game<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="#">New</a></li>
            <li><a href="#">Load</a></li>
            <li class="divider"></li>
            <li><a href="#">Retire</a></li>
          </ul>
        </li>
        <li class="dropdown"><a href="#">FourXpedia</a></li>
        <li><a href="#about">About</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="container">
  <div class="jumbotron">
    <p><a href="#" class="btn btn-primary btn-lg" id="create_map" role="button">Create dummy starmap &raquo;</a></p>
    <div id="map_container"></div>
  </div>
</div>
<!-- remove http: when deployed -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<!-- remove http: when deployed -->
<script src="js/three.min.js"></script>
<script>
    $(document).ready(function(){
      var starmap_url = "http://localhost:8080/resources/dummy-starmap";
      var $map_container = $('#map_container');
      var spectral_types = {
        O : 0x0000ff, // blue
        B : 0x00ffff, // blue-white
        A : 0xffffff, // white
        F : 0xffff99, // yellow-whit
        G : 0xffff00, // yellow
        K : 0xff9933, // orange
        M : 0xff0000 //red
      };
      $( "#create_map" ).click(function() {
        $('#map_container').empty();
        $.getJSON( starmap_url, function(json) {
        var starmap = json;
        // scene size
        var WIDTH = 1000,
        HEIGHT = 600;
        // camera attributes
        var VIEW_ANGLE = 45, ASPECT = WIDTH / HEIGHT, NEAR = 0.1, FAR = 10000;
        if (window.WebGLRenderingContext)
        	renderer = new THREE.WebGLRenderer();
        else
          renderer = new THREE.CanvasRenderer();
	    var camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);
	    var scene = new THREE.Scene();
	    camera.position.z = 1500;
	    renderer.setSize(WIDTH, HEIGHT);
	    $map_container.append(renderer.domElement);
	    var radius = 10, segments = 16, rings = 16;
        for (var i in starmap.stars) {
          var x = starmap.stars[i]['coordinates']['x'];
          var y = starmap.stars[i]['coordinates']['y'];
          var z = starmap.stars[i]['coordinates']['z'];
          var sphereMaterial = new THREE.MeshLambertMaterial({color: spectral_types[starmap.stars[i]['type'].charAt(0)]});
          var sphere = new THREE.Mesh(
            new THREE.SphereGeometry(radius, segments, rings),
            sphereMaterial);
            sphere.position.set(x,y,z);
            scene.add(sphere);
        }
        var directionalLight = new THREE.DirectionalLight(0x9f9f9f, 1);
        directionalLight.position.set(1, 1, 1);
        scene.add(camera);
        scene.add(directionalLight);
	    renderer.render(scene, camera);
    });
  });
});
</script>
</body>
</html>
